"use strict";(()=>{var e={};e.id=892,e.ids=[892],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14822:(e,s,r)=>{r.r(s),r.d(s,{originalPathname:()=>y,patchFetch:()=>h,requestAsyncStorage:()=>m,routeModule:()=>g,serverHooks:()=>b,staticGenerationAsyncStorage:()=>f});var t={};r.r(t),r.d(t,{GET:()=>c,POST:()=>d,PUT:()=>p});var a=r(49303),n=r(88716),o=r(60670),u=r(87070);let i=new(r(53524)).PrismaClient;async function c(e){try{let{searchParams:s}=new URL(e.url),r=s.get("businessId");if(!r)return u.NextResponse.json({error:"Business ID required"},{status:400});let t=await i.business.findUnique({where:{id:r},include:{user:!0}});if(!t)return u.NextResponse.json({error:"Business not found"},{status:404});return u.NextResponse.json({success:!0,business:{id:t.id,name:t.name,category:t.category,whatsappNumber:t.whatsappNumber,virtualNumber:t.virtualNumber,address:t.address,config:t.config,isActive:t.isActive,createdAt:t.createdAt}})}catch(e){return console.error("Error fetching business config:",e),u.NextResponse.json({error:"Internal server error"},{status:500})}}async function d(e){try{let{businessId:s,config:r}=await e.json();if(!s||!r)return u.NextResponse.json({error:"Business ID and config are required"},{status:400});let t={name:r.name||"",category:r.category||"retail",products:r.products||[],hours:r.hours||l(),address:r.address||"",customFAQs:r.customFAQs||[],greetingMessage:r.greetingMessage,fallbackMessage:r.fallbackMessage},a=await i.business.update({where:{id:s},data:{name:t.name,category:t.category,address:t.address,config:t}});return u.NextResponse.json({success:!0,message:"Configuration updated successfully",business:{id:a.id,name:a.name,config:a.config}})}catch(e){return console.error("Error updating business config:",e),u.NextResponse.json({error:"Internal server error"},{status:500})}}async function p(e){try{let{userId:s,businessData:r}=await e.json();if(!s||!r)return u.NextResponse.json({error:"User ID and business data are required"},{status:400});let t=`whatsapp:+1415523${Math.floor(1e3+9e3*Math.random())}`,a={name:r.name,category:r.category||"retail",products:r.products||[],hours:r.hours||l(),address:r.address||"",customFAQs:[],greetingMessage:`\xa1Hola! Bienvenido a ${r.name}. \xbfEn qu\xe9 puedo ayudarte?`,fallbackMessage:`Un ejecutivo de ${r.name} te contactar\xe1 pronto para ayudarte 👨‍💼`},n=await i.business.create({data:{name:r.name,category:r.category||"retail",whatsappNumber:r.whatsappNumber,virtualNumber:t,address:r.address,config:a,userId:s}});return u.NextResponse.json({success:!0,message:"Business created successfully",business:{id:n.id,name:n.name,virtualNumber:n.virtualNumber,config:n.config}})}catch(e){return console.error("Error creating business:",e),u.NextResponse.json({error:"Internal server error"},{status:500})}}function l(){return{monday:{open:"09:00",close:"18:00",closed:!1},tuesday:{open:"09:00",close:"18:00",closed:!1},wednesday:{open:"09:00",close:"18:00",closed:!1},thursday:{open:"09:00",close:"18:00",closed:!1},friday:{open:"09:00",close:"18:00",closed:!1},saturday:{open:"10:00",close:"14:00",closed:!1},sunday:{open:"00:00",close:"00:00",closed:!0}}}let g=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/business/config/route",pathname:"/api/business/config",filename:"route",bundlePath:"app/api/business/config/route"},resolvedPagePath:"C:\\Users\\CODING\\Documents\\NEWERA\\VENDEBOT\\vendebot\\src\\app\\api\\business\\config\\route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:m,staticGenerationAsyncStorage:f,serverHooks:b}=g,y="/api/business/config/route";function h(){return(0,o.patchFetch)({serverHooks:b,staticGenerationAsyncStorage:f})}}};var s=require("../../../../webpack-runtime.js");s.C(e);var r=e=>s(s.s=e),t=s.X(0,[276,972],()=>r(14822));module.exports=t})();